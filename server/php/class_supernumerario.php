<?phprequire_once("../librerias/lib/connection.php");class supernumerario{	/*	~Objetos de la clase 		 $lista {objeto que obtiene los datos de las sentencias sql y se retorna al controlador}		 $cod_epl {Objeto que obtiene el codigo del jefe para pasar como parametro a las sentencias sql}~	*/		/*----------------------*/	private $lista=array();	private $lista2=array();	private $cod_epl=null;		/*----------------------*/			/*     METODOS SET Y GET DE LA CLASE     */	public function set_empleado($cod_epl){			$this->cod_epl=$cod_epl;		}		private	function get_empleado(){		return $this->cod_epl;	}	/*---------------------------------------*/	/////ROBER			//Todos los empleados de cmi activos	public function empleados_cmi(){		try{			global $conn;						$sql="select em.cod_epl,em.nom_epl,em.ape_epl,cent.nom_cc2,car.nom_car				from empleados_basic as em, centrocosto2 as cent, cargos as car				where em.estado='A' and em.cod_car=car.cod_car and em.cod_cc2=cent.cod_cc2 and em.cod_epl not in(select cod_epl from supernumerario) 				and em.cod_cc2 not in ('60030302','CA010308','AD60030302',' AC010308','20')order by car.nom_car";			$rs=$conn->Execute($sql);			while($fila=$rs->FetchRow()){				$this->lista[]=array("cedula"=> $fila["cod_epl"],									 "nombre_completo"=> utf8_encode($fila["nom_epl"]." ".$fila["ape_epl"]),									 "centro_costo"=> utf8_encode($fila["nom_cc2"]),									 "cargo"=> utf8_encode($fila["nom_car"]));			}						return $this->lista;					}catch(exception $e){			 var_dump($e);            adodb_backtrace($e->gettrace());		}		}		//Todos los empleados externos(listos)	public function empleados_externos(){		try{			global $conn;						$sql="select distinct em.cod_eplc,em.nom_eplc,em.ape_eplc,cent.nom_cc2,car.nom_car				  from epl_ctistas2 as em, centrocosto2 as cent, cargos as car				  where em.estado='A' and em.cod_car=car.cod_car and em.cod_cc2=cent.cod_cc2 and em.cod_eplc not in(select cod_epl from supernumerario)";			$rs=$conn->Execute($sql);			while($fila=$rs->FetchRow()){				$this->lista[]=array("cedulac"=> $fila["cod_eplc"],									 "nombre_completoc"=> utf8_encode($fila["nom_eplc"]." ".$fila["ape_eplc"]),									 "centro_costoc"=> utf8_encode($fila["nom_cc2"]),									 "cargoc"=> utf8_encode($fila["nom_car"]));			}						return $this->lista;					}catch(exception $e){			 var_dump($e);            adodb_backtrace($e->gettrace());		}			}		public function empleados_cmi_id($id){		unset($this->lista);		try{			global $conn;						$sql="select em.cod_epl,em.cod_cc2,em.cod_car				  from empleados_basic as em                  where em.cod_epl='".$id."'";			$rs=$conn->Execute($sql);			while($fila=$rs->FetchRow()){				$this->lista[]=array("cedula"=> $fila["cod_epl"],									 "cargo"=> $fila["cod_car"],									 "centro_costo"=> $fila["cod_cc2"]);			}						return $this->lista;					}catch(exception $e){			 var_dump($e);            adodb_backtrace($e->gettrace());		}	}		public function empleados_externos_id($id){			unset($this->lista);		try{			global $conn;						$sql="select em.cod_eplc,em.cod_cc2,em.cod_car				  from epl_ctistas2 as em				  where em.cod_eplc='".$id."'";			$rs=$conn->Execute($sql);			while($fila=$rs->FetchRow()){				$this->lista[]=array("cedulac"=> $fila["cod_eplc"],									 "centro_costoc"=> $fila["cod_cc2"],									 "cargoc"=> $fila["cod_car"]);			}						return $this->lista;					}catch(exception $e){			 var_dump($e);            adodb_backtrace($e->gettrace());		}	}		public function agregar_supernume($super1,$super2){					global $conn;			foreach($super1 as $value1){								$empleado1=$this->empleados_cmi_id($value1);				/*$sql="select count(*) as contar from supernumerario";				$rs=$conn->Execute($sql);				$fila=$rs->FetchRow();				$id=(int)$fila["contar"]+1;*/								$sql2="insert into supernumerario values('".$empleado1[0]['cedula']."','".$empleado1[0]['cargo']."','".$empleado1[0]['centro_costo']."','A')";				$rs2=$conn->Execute($sql2);			}						foreach($super2 as $value2){								$empleado2=$this->empleados_externos_id($value2);								$sql4="insert into supernumerario values('".$empleado2[0]['cedulac']."','".$empleado2[0]['cargoc']."','".$empleado2[0]['centro_costoc']."','A')";						$rs4=$conn->Execute($sql4);			}						if($rs4)				return 1;			else				return 2;	}		public function agregar_supernume1($super1){					global $conn;			foreach($super1 as $value1){								$empleado1=$this->empleados_cmi_id($value1);				$sql2="insert into supernumerario values('".$empleado1[0]['cedula']."','".$empleado1[0]['cargo']."','".$empleado1[0]['centro_costo']."','A')";				$rs2=$conn->Execute($sql2);			}									if($rs2)				return 1;			else				return 2;	}		public function agregar_supernume2($super2){				global $conn;		foreach($super2 as $value2){								$empleado2=$this->empleados_externos_id($value2);								$sql4="insert into supernumerario values('".$empleado2[0]['cedulac']."','".$empleado2[0]['cargoc']."','".$empleado2[0]['centro_costoc']."','A')";						$rs4=$conn->Execute($sql4);			}						if($rs4)				return 1;			else				return 2;						}		public function get_supernumerarios($accion){		try{			global $conn;			if($accion=="select"){				$estado="and super.estado='A'";			}else{				$estado='';			}			$sql="select super.cod_epl as codigo,car.nom_car as cargo,cent.nom_cc2 as centro_costo,em.nom_epl as nombre,ape_epl as apellido,(case super.estado when 'A' then 'Activo' else 'Inactivo'  END) as estado					from cargos as car,centrocosto2 as cent, supernumerario as super, empleados_basic as em					where  super.cod_car=car.cod_car and super.cod_cc2=cent.cod_cc2 and super.cod_epl=em.cod_epl  $estado					union					select super.cod_epl as codigo,car.nom_car as cargo,cent.nom_cc2 as centro_costo,em.nom_eplc as nombre,ape_eplc as apellido,(case super.estado when 'A' then 'Activo' else 'Inactivo'  END)as estado					from cargos as car,centrocosto2 as cent, supernumerario as super, epl_ctistas2 as em					where  super.cod_car=car.cod_car and super.cod_cc2=cent.cod_cc2 and super.cod_epl=em.cod_eplc $estado order by em.nom_epl asc";			$rs=$conn->Execute($sql);			while($fila=$rs->FetchRow()){				$this->lista[]=array("cedula"=> $fila["codigo"],									 "cargo"=> utf8_encode($fila["cargo"]),									 "centro_costo"=>utf8_encode( $fila["centro_costo"]),									 "nombre_completo"=> utf8_encode($fila["nombre"]." ".$fila["apellido"]),									 "estado"=>$fila["estado"]);			}						return $this->lista;					}catch(exception $e){			 var_dump($e);            adodb_backtrace($e->gettrace());		}		}		/*public function get_supernumerario_cargo($id){		try{			global $conn;			$sql="select nom_epl+''+ape_epl as nombres from empleados_basic where cod_epl = '".$id."'";			$rs=$conn->Execute($sql);			while($fila=$rs4->FetchRow()){				$this->lista[]=array("cedula"=> $fila["codigo"],									 "nombre_completo"=> utf8_encode($fila["nombres"]));			}						return $this->lista;					}catch(exception $e){			 var_dump($e);            adodb_backtrace($e->gettrace());		}		}*/		public function activar_supernumerario($cedula,$estado){				global $conn;						if($estado=='Inactivo'){						$sql="update supernumerario set estado='A' where cod_epl='".$cedula."'";							$rs=$conn->Execute($sql);				if($rs)					return 1;				else					return 2;			}				$sql2="select top(1) (case when fec_fin <> ' ' THEN(select  top(1) MAX(convert(varchar,fec_fin,105))as fec_fin from supernumerario_nov where cod_epl_super = '".$cedula."')ELSE ' ' end ) as fec_fin  		      from supernumerario_nov where cod_epl_super='".$cedula."'";				$rs2=$conn->Execute($sql2);		$fila2=$rs2->FetchRow();		$fec_fin=$fila2["fec_fin"];		//var_dump($fec_fin);exit;				if($fec_fin==" " || $fec_fin==NULL){								$sql="update supernumerario set estado='I' where cod_epl='".$cedula."'";				$rs=$conn->Execute($sql);								if($rs)					return 1;				else					return 2;								}else{							date_default_timezone_set("America/Bogota");			//var_dump($fec_fin);die();			$fec_fin=strtotime($fec_fin);			$hoy=date("d-m-Y",time());			$hoy=strtotime($hoy);						/*$hoy="26-07-2013";			$hoy=strtotime($hoy);*/					//var_dump($hoy."----".$fec_fin);die();									    if($hoy > $fec_fin && $estado=='Activo'){						$sql="update supernumerario set estado='I' where cod_epl='".$cedula."'";						$rs=$conn->Execute($sql);												if($rs)							return 1;						else							return 2;												    }else{						return 3;				    }		}				}		public function add_movreemp($super,$reemp,$fecini,$fecfin,$jefe,$cen_costo,$obs,$baja){ //dia-mes-aÃ±o		global $conn;							$sql2="SELECT * FROM SUPERNUMERARIO_NOV 			where cod_epl_super='".$super."'			and (convert(date,'".$fecini."',105) BETWEEN fec_ini AND FEC_FIN 			OR convert(date,'".$fecfin."',105) BETWEEN FEC_INI AND fec_fin) ";				$rs2=$conn->Execute($sql2);				if($rs2->RecordCount() > 0){					return 3;				}else{							$sql="insert into supernumerario_nov(cod_epl_super,cod_epl_reemp,fec_ini,fec_fin,cod_epl_jefe,cod_cc2,observaciones,tipo_baja) 					values('".$super."','".$reemp."',convert(varchar,'".$fecini." 00:00:00.000',21),convert(varchar,'".$fecfin." 00:00:00.000',21),'".$jefe."','".$cen_costo."','".$obs."','".$baja."')";										$rs=$conn->Execute($sql);				if($rs)					return 1;				else					return 2;			}	}				public function add_movcubri($super,$fec_ini,$fec_fin,$jefe,$cen_costo,$obs){				global $conn;				$sql4="SELECT * FROM SUPERNUMERARIO_NOV 				where cod_epl_super='".$super."'				and (convert(date,'".$fec_ini."',105) BETWEEN fec_ini AND FEC_FIN 				OR convert(date,'".$fec_fin."',105) BETWEEN FEC_INI AND fec_fin)";						$rs4=$conn->Execute($sql4);							if($rs4->RecordCount() > 0){					return 4;		}						$sql="insert into supernumerario_nov(cod_epl_super,fec_ini,fec_fin,cod_epl_jefe,cod_cc2,observaciones,tipo_baja) 		  values('".$super."',convert(varchar,'".$fec_ini." 00:00:00.000',21),convert(varchar,'".$fec_fin." 00:00:00.000',21),'".$jefe."','".$cen_costo."','".$obs."','04')";		  		$rs=$conn->Execute($sql);			if($rs)				return 1;			else				return 2;		}		public function get_reemplazo(){		try{			global $conn;						$sql="select em.cod_epl,em.nom_epl,em.ape_epl,cent.nom_cc2,car.nom_car				from empleados_basic as em, centrocosto2 as cent, cargos as car				where em.estado='A' and em.cod_car=car.cod_car and em.cod_cc2=cent.cod_cc2 order by em.nom_epl asc";			$rs=$conn->Execute($sql);			while($fila=$rs->FetchRow()){				$this->lista[]=array("cedula"=> $fila["cod_epl"],									 "nombre_completo"=> utf8_encode($fila["nom_epl"]." ".$fila["ape_epl"]),									);			}						return $this->lista;					}catch(exception $e){			 var_dump($e);            adodb_backtrace($e->gettrace());		}	}		public function get_tipobaja(){		try{			global $conn;						$sql="select * from tipo_baja where tipo_baja <> 04";			$rs=$conn->Execute($sql);			while($fila=$rs->FetchRow()){				$this->lista[]=array("tipo_baja"=>$fila["tipo_baja"],									 "nombre"=>utf8_encode($fila["nombre"]),									);			}						return $this->lista;					}catch(exception $e){			 var_dump($e);            adodb_backtrace($e->gettrace());		}	}		/*public function get_reemplazo2($id){		try{			global $conn;						$sql="select cod_car from empleados_basic where cod_epl = '".$id."'";			$rs=$conn->Execute($sql);			$fila=$rs->FetchRow();			$cargo=$fila["cod_car"];						if($cargo==""){				$sql3="select cod_car from epl_ctistas2 where cod_eplc = '".$id."'";				$rs3=$conn->Execute($sql3);				$fila3=$rs3->FetchRow();				$cargo=$fila3["cod_car"];			}						$sql2="select bas.cod_epl,bas.nom_epl,bas.ape_epl from empleados_basic bas, empleados_gral gral where bas.cod_epl=gral.cod_epl and gral.cod_jefe<>''					and bas.estado='A' 					and bas.cod_car='".$cargo."' 					and bas.cod_epl <> '".$id."' order by bas.nom_epl asc";			$rs2=$conn->Execute($sql2);			while($fila2=$rs2->FetchRow()){				$this->lista[]=array("cedula"=> $fila2["cod_epl"],									 "nombre_completo"=> utf8_encode($fila2["nom_epl"]." ".$fila2["ape_epl"]));			}						return $this->lista;					}catch(exception $e){			 var_dump($e);            adodb_backtrace($e->gettrace());		}		}*/		public function  get_reemplazo2($supernu){		try{			global $conn;						$sql3="select cod_jefe from empleados_gral where cod_epl='".$supernu."'";			$rs3=$conn->Execute($sql3);			$row3=$rs3->FetchRow();						$sql2="SELECT bas.cod_epl,(bas.nom_epl+' '+bas.ape_epl)as nombres FROM empleados_basic bas,empleados_gral gral,centrocosto2 cen			    where bas.cod_epl=gral.cod_Epl			    and bas.cod_cc2=cen.cod_cc2			    and cen.estado='A'			    and gral.cod_jefe <> '' 			    and bas.estado='A' and bas.cod_cc2 <>'CA010308' --que no me traiga los empledos del sena // consulta que me trae todos los empleados_basic que tenga--				and gral.cod_jefe <> '".@$row3['cod_jefe']."'				"; 				//codigo de jefe			$rs2=$conn->Execute($sql2);			while($fila2=$rs2->FetchRow()){				$this->lista[]=array("cedula"=> $fila2["cod_epl"],									 "nombre_completo"=> utf8_encode($fila2["nombres"]));			}						return $this->lista;					}catch(exception $e){			 var_dump($e);            adodb_backtrace($e->gettrace());		}	}		public function get_jefe($id){			global $conn;				$sql2="select bas.cod_epl,bas.cod_car,car.nom_car,bas.cod_cc2,costo.nom_cc2,			   gral.cod_jefe,(select nom_epl+' '+ape_epl from empleados_basic where cod_epl=gral.cod_jefe)as jefe			   from empleados_basic bas, empleados_gral gral,centrocosto2 costo,cargos car			   where bas.cod_epl=gral.cod_epl			   and gral.cod_jefe <> '' and bas.cod_epl='".$id."'			   and bas.cod_cc2=costo.cod_cc2			   and bas.cod_car=car.cod_car";			$rs2=$conn->Execute($sql2);			while($fila2=$rs2->FetchRow()){				$this->lista[]=array("cargo"=> $fila2["cod_car"],									  "nom_car"=>$fila2["nom_car"],									  "cod_cc2"=>$fila2["cod_cc2"],									  "area"=>$fila2["nom_cc2"],									  "cod_epl_jefe"=>$fila2["cod_jefe"],									  "nom_jefe"=>$fila2["jefe"]);			}						return $this->lista;		}		public function get_all_jefe(){			global $conn;			$sql2="select distinct jef.cod_epl,jef.nom_epl+' '+jef.ape_epl as jefe  from empleados_gral gral, empleados_basic bas,empleados_basic jef where bas.cod_Epl=gral.cod_epl and cod_jefe <>''					and bas.estado='A'					and jef.cod_epl=gral.cod_jefe					and jef.estado='A'					order by jefe asc";			$rs2=$conn->Execute($sql2);			while($fila2=$rs2->FetchRow()){				$this->lista[]=array("codigo"=> $fila2["cod_epl"],									  "jefe"=>$fila2["jefe"]									);			}						return $this->lista;		}		public function areas_jefe($codigo){		try { 			global $conn;			$sql="SELECT distinct AREA.COD_CC2,   AREA.NOM_CC2 FROM  CENTROCOSTO2 AREA, EMPLEADOS_BASIC EPL, EMPLEADOS_GRAL GRAL					WHERE EPL.COD_EPL = GRAL.COD_EPL					AND EPL.COD_CC2=AREA.COD_CC2					and gral.COD_JEFE = '".$codigo."'					and area.estado='A'					and epl.estado='A'";			$rs=$conn->Execute($sql);			while($fila=$rs->FetchRow()){				$this->lista[]=array("codigo" => $fila["COD_CC2"],									 "area"	  => utf8_encode($fila["NOM_CC2"]));			}						return $this->lista;		}catch (exception $e) {            var_dump($e);            adodb_backtrace($e->gettrace());		} 	}		public function get_super_nov(){		try { 			global $conn;			$sql="select nov.id,bas.nom_epl+' '+bas.ape_epl as supernumerario,				(case when cod_epl_reemp <>' ' THEN (select nom_epl+' '+ape_epl from empleados_basic where cod_epl=cod_epl_reemp) 				else ' ' end)as reemplazo,				convert(varchar,nov.fec_ini,105) as fec_ini, convert(varchar,nov.fec_fin,105) as fec_fin, (select nom_epl+' '+ape_epl from empleados_basic where cod_epl=cod_epl_jefe) as jefe,				cc2.nom_cc2,nov.observaciones,tipo.nombre,(case when cod_epl_reemp <> ' ' THEN (select convert(varchar,fec_ing,105) from empleados_basic where cod_epl=cod_epl_reemp)else ' ' end )as fecha_ing				from supernumerario_nov as nov, empleados_basic as bas, centrocosto2 as cc2,tipo_baja as tipo				where				bas.cod_epl=nov.cod_epl_super				and nov.cod_cc2=cc2.cod_cc2				and tipo.tipo_baja=nov.tipo_baja				UNION				select nov.id,bas.nom_eplc+' '+bas.ape_eplc as supernumerario, 				(case when cod_epl_reemp <> ' ' THEN (select nom_epl+' '+ape_epl from empleados_basic where cod_epl=cod_epl_reemp)				ELSE ' ' end) as reemplazo,				convert(varchar,nov.fec_ini,105) as fec_ini, convert(varchar,nov.fec_fin,105) as fec_fin, (select nom_epl+' '+ape_epl from empleados_basic where cod_epl=cod_epl_jefe) as jefe,				cc2.nom_cc2,nov.observaciones,tipo.nombre,(case when cod_epl_reemp <> ' ' THEN (select convert(varchar,fec_ing,105) from empleados_basic where cod_epl=cod_epl_reemp)else ' ' end )as fecha_ing				from supernumerario_nov as nov, epl_ctistas2 as bas, centrocosto2 as cc2,tipo_baja as tipo				where				bas.cod_eplc=nov.cod_epl_super				and nov.cod_cc2=cc2.cod_cc2				and tipo.tipo_baja=nov.tipo_baja				order by fec_ini desc				";				//var_dump($sql);die();							$rs=$conn->Execute($sql);			while($fila=$rs->FetchRow()){					@$fec_ini=explode(" ",$fila["fec_ini"]);					@$fec_fin=explode(" ",$fila["fec_fin"]);					//if($fila["fec_ing"] == '1900-01-01 00:00:00.000'){$fila["fec_ing"]="";}													$this->lista[]=array("supernumerario" => utf8_encode($fila["supernumerario"]),									 "reemplazo"	  => utf8_encode($fila["reemplazo"]),									 "jefe"           => utf8_encode(@$fila["jefe"]),									 "ingreso"        => $fila["fecha_ing"],									 "fec_ini"        => $fec_ini[0],									 "fec_fin"        => $fec_fin[0],									 "area"           => utf8_encode($fila["nom_cc2"]),									 "observaciones"  => utf8_encode($fila["observaciones"]),									 "baja"           => utf8_encode($fila["nombre"]),									 "id"             => $fila["id"]);			}						return $this->lista;					}catch (exception $e) {            var_dump($e);            adodb_backtrace($e->gettrace());		} 		}		/*esta funcion sirve cuando el id es de un reemplazo o cubrimiento*/	public function cubri_reemplazo($id){		global $conn;		try { 						$sql="select (case when count(cod_epl_reemp) <> 0 then 'REEMPLAZO' ELSE 'CUBRIMIENTO' END) AS editar from supernumerario_nov where id='".$id."'";							$rs=$conn->Execute($sql);			while($fila=$rs->FetchRow()){									$this->lista[]=array("editar" => $fila["editar"]);			}						return $this->lista;					}catch (exception $e) {            var_dump($e);            adodb_backtrace($e->gettrace());		} 		}		/*funcion para traer los codigos de la tabla supernumerario_nov con el id del supernumerario*/	public function supernumerario_id($id){		global $conn;		try { 						/*$sql="select car.cod_car, car.nom_car, nov.* from supernumerario_nov as nov,empleados_basic as bas, cargos as car 					where nov.id='".$id."'					and bas.cod_car=car.cod_car					and bas.cod_epl=cod_epl_reemp and bas.estado='A'";*/								$sql="select car.cod_car, car.nom_car, nov.cod_epl_super, RTRIM(bas1.nom_epl)+' '+RTRIM(bas1.ape_epl) as supernumerario  ,nov.cod_epl_reemp,RTRIM(bas2.nom_epl)+' '+RTRIM(bas2.ape_epl) as reemplazo, nov.cod_epl_jefe, RTRIM(bas3.nom_epl)+' '+RTRIM(bas3.ape_epl) as jefe,					convert(varchar,nov.fec_ini,105) as fecha_ini, convert(varchar,nov.fec_fin,105) as fecha_fin, baja.nombre as baja, ccosto.nom_cc2, nov.tipo_baja, nov.cod_cc2					from supernumerario_nov as nov,empleados_basic as bas1, cargos as car,					empleados_basic as bas2, empleados_basic as bas3, tipo_baja as baja, centrocosto2 as ccosto					where nov.id='".$id."'					and bas1.cod_car=car.cod_car					and nov.cod_epl_super=bas1.cod_epl					and nov.cod_epl_reemp=bas2.cod_epl					and nov.cod_epl_jefe=bas3.cod_epl					and bas1.estado='A'					and nov.tipo_baja=baja.tipo_baja					and  nov.cod_cc2=ccosto.cod_cc2					union					select car.cod_car, car.nom_car, nov.cod_epl_super, RTRIM(bas1.nom_eplc)+' '+RTRIM(bas1.ape_eplc) as supernumerario , nov.cod_epl_reemp, RTRIM(bas2.nom_epl)+' '+RTRIM(bas2.ape_epl) as reemplazo, nov.cod_epl_jefe, RTRIM(bas3.nom_epl)+' '+RTRIM(bas3.ape_epl) as jefe,					convert(varchar,nov.fec_ini,105) as fecha_ini, convert(varchar,nov.fec_fin,105) as fecha_fin, baja.nombre as baja, ccosto.nom_cc2, nov.tipo_baja, nov.cod_cc2					from supernumerario_nov as nov,epl_ctistas2 as bas1, cargos as car,					empleados_basic as bas2, empleados_basic as bas3, tipo_baja as baja, centrocosto2 as ccosto					where nov.id='".$id."'					and bas1.cod_car=car.cod_car					and nov.cod_epl_super=bas1.cod_eplc					and nov.cod_epl_reemp=bas2.cod_epl					and nov.cod_epl_jefe=bas3.cod_epl					and bas1.estado='A'					and nov.tipo_baja=baja.tipo_baja					and  nov.cod_cc2=ccosto.cod_cc2										";																	$rs=$conn->Execute($sql);			while($fila=$rs->FetchRow()){									$this->lista[]=array("cod_epl_super" => $fila["cod_epl_super"],									 "supernumerario" => $fila["supernumerario"],									 "cod_epl_reemp"=>$fila["cod_epl_reemp"],									 "reemplazo" => $fila["reemplazo"],									 "cod_epl_jefe"=>$fila["cod_epl_jefe"],									 "jefe"=>    $fila["jefe"],									 "nom_cc2"=>$fila["nom_cc2"],									 "centro_costo2"=>$fila["cod_cc2"],									 "nombre_baja"=>$fila["baja"],									 "tipo_baja" => $fila["tipo_baja"],									 "cod_car"=>$fila["cod_car"],									 "nom_car"=>$fila["nom_car"],									 "fecha_ini"=>$fila["fecha_ini"],									 "fecha_fin"=>$fila["fecha_fin"]);			}						return $this->lista;					}catch (exception $e) {            var_dump($e);            adodb_backtrace($e->gettrace());		} 	}		/*funcion para traer los codigos de la tabla supernumerario_nov con el id del supernumerario si es de cubrumiento*/	public function supernumerario_id2($id){		global $conn;		try { 						$sql="select car.cod_car, car.nom_car, nov.* from supernumerario_nov as nov,empleados_basic as bas, cargos as car 				where nov.id='".$id."'				and bas.cod_car=car.cod_car				and bas.cod_epl=nov.cod_epl_super and bas.estado='A'				union				select car.cod_car, car.nom_car, nov.* from supernumerario_nov as nov,epl_ctistas2 as bas, cargos as car 				where nov.id='".$id."'				and bas.cod_car=car.cod_car				and bas.cod_eplc=nov.cod_epl_super and bas.estado='A'";										$rs=$conn->Execute($sql);			while($fila=$rs->FetchRow()){				$this->lista[]=array("cod_epl_super" => $fila["cod_epl_super"],									 "cod_epl_jefe"=>$fila["cod_epl_jefe"],									 "cod_cc2"=>$fila["cod_cc2"],									 "tipo_baja"=>$fila["tipo_baja"],									 "cod_car"=>$fila["cod_car"],									 "nom_car"=>$fila["nom_car"]);			}						return $this->lista;					}catch (exception $e) {            var_dump($e);            adodb_backtrace($e->gettrace());		} 	}		public function eliminar_movimiento($id,$fecha){		global $conn;				$fecha=explode("-",$fecha);				$sql = "delete from supernumerario_nov where id ='$id'";		$rs=$conn->Execute($sql);		if($rs){			$respuesta="<span style='text-align:center;'>Se Elimino el registro satisfactoriamente.</span>";		}else{			$respuesta="<span style='text-align:center;'>Error al Eliminar el registro.</span>";		}		return $respuesta;	}		/*actualiza los datos de la tabla admin supernumerario cuando es supernumerario*/	public function update_movreemp($id,$super,$reemp,$fec_ini,$fec_fin,$jefe,$cen_costo,$obs,$baja,$reemp_old){				global $conn;				/*SUPERNUMERARIO  EN EL RANGO DE FECHAS NO TENGA OTRO REEMPLAZO*/		$sql5="select *from supernumerario_nov				where cod_epl_super = '".$super."' 				and (convert(date,'".$fec_ini."',105) BETWEEN fec_ini AND FEC_FIN 				OR convert(date,'".$fec_fin."',105) BETWEEN FEC_INI AND fec_fin)				and Id <> '".$id."'";								$rs5=$conn->Execute($sql5);				if($rs5->RecordCount() > 0){						return 3;				}				/*SUPERNUMERARIO NO TIENE CUBRIMIENTO*/		$sql6="select *from supernumerario_nov				where cod_epl_super = '".$super."'  AND cod_epl_reemp is null 				and (convert(date,'".$fec_ini."',105) BETWEEN fec_ini AND FEC_FIN 				OR convert(date,'".$fec_fin."',105) BETWEEN FEC_INI AND fec_fin)				and Id <> '".$id."'";						$rs6=$conn->Execute($sql6);				if($rs6->RecordCount() > 0){						return 4;				}				$sql="update supernumerario_nov set cod_epl_super='".$super."', cod_epl_reemp='".$reemp."', fec_ini=convert(varchar,'".$fec_ini." 00:00:00.000',21),		  fec_fin=convert(varchar,'".$fec_fin." 00:00:00.000',21),cod_epl_jefe='".$jefe."', cod_cc2='".$cen_costo."', observaciones='".$obs."', tipo_baja='".$baja."' 		  where id='".$id."'";  		  		$rs=$conn->Execute($sql);			if($rs)				return 1;			else				return 2;	}		/*actualiza los datos de la tabla admin supernumerario cuando es supernumerario*/	public function update_movcubri($id,$super,$fec_ini,$fec_fin,$jefe,$cen_costo,$obs){			global $conn;				/*SUPERNUMERARIO  EN EL RANGO DE FECHAS NO TENGA OTRO REEMPLAZO*/		$sql5="select *from supernumerario_nov				where cod_epl_super = '".$super."' 				and (convert(date,'".$fec_ini."',105) BETWEEN fec_ini AND FEC_FIN 				OR convert(date,'".$fec_fin."',105) BETWEEN FEC_INI AND fec_fin)				and Id <> '".$id."'";				$rs5=$conn->Execute($sql5);						if($rs5->RecordCount() > 0){						return 3;				}		/*SUPERNUMERARIO NO TIENE CUBRIMIENTO*/		$sql6="select *from supernumerario_nov				where cod_epl_super = '".$super."'  AND cod_epl_reemp is null 				and (convert(date,'".$fec_ini."',105) BETWEEN fec_ini AND FEC_FIN 				OR convert(date,'".$fec_fin."',105) BETWEEN FEC_INI AND fec_fin)				and Id <> '".$id."'";						$rs6=$conn->Execute($sql6);				if($rs6->RecordCount() > 0){						return 4;				}									$sql="update supernumerario_nov set cod_epl_super='".$super."', fec_ini=convert(varchar,'".$fec_ini." 00:00:00.000',21),		  fec_fin=convert(varchar,'".$fec_fin." 00:00:00.000',21),cod_epl_jefe='".$jefe."', cod_cc2='".$cen_costo."', observaciones='".$obs."'		  where id='".$id."'";  		$rs=$conn->Execute($sql);			if($rs)				return 1;			else				return 2;							}		/* 	----------------------------------------------------- FIN METODOS ---------------------------------------------------------------------- */}